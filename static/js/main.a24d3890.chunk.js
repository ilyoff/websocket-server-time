(this["webpackJsonpnovakids-test"]=this["webpackJsonpnovakids-test"]||[]).push([[0],{22:function(e,t,n){e.exports=n(55)},27:function(e,t,n){},28:function(e,t,n){},46:function(e,t,n){},47:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(20),o=n.n(c),u=(n(27),n(3)),s=n(4),i=n(5),l=function(){function e(){Object(s.a)(this,e)}return Object(i.a)(e,null,[{key:"get",value:function(){return localStorage.getItem(this.key)}},{key:"set",value:function(t){localStorage.setItem(e.key,t)}},{key:"remove",value:function(){localStorage.removeItem(e.key)}}]),e}();l.key="token";var m,f=l,d=r.a.createContext({isLoggedIn:!1,setStateOnLogin:function(){},logout:function(){}}),v=(n(28),n(7)),b=n(21),p=n.n(b);!function(e){e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.InternalServerError=500]="InternalServerError"}(m||(m={}));var g=p.a.create({baseURL:"https://work.vint-x.net/api",headers:{accept:"application/json"}});g.interceptors.request.use((function(e){var t=f.get();return t?Object(v.a)({},e,{headers:Object(v.a)({},e.headers,{"x-test-app-jwt-token":t})}):e}));var h=g,j=new(function(){function e(){Object(s.a)(this,e)}return Object(i.a)(e,[{key:"login",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;return h.post("/login",e).then((function(e){var t=e.headers["x-test-app-jwt-token"];return f.set(t),t})).catch((function(a){var r,c=null===a||void 0===a||null===(r=a.response)||void 0===r?void 0:r.status;return c!==m.BadRequest&&c!==m.Unauthorized&&n>0?t.login(e,n-1):Promise.reject(a.response.data)}))}},{key:"subscribe",value:function(){return h.get("/subscribe").then((function(e){return e.data.url})).catch((function(e){var t;return Promise.reject(null===(t=e.response)||void 0===t?void 0:t.status)}))}}]),e}()),O=(n(46),function(e){var t=e.className,n=e.children;return r.a.createElement("article",{className:"box ".concat(t)},n)}),_=function(){var e=Object(a.useState)(""),t=Object(u.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(""),s=Object(u.a)(o,2),i=s[0],l=s[1],m=Object(a.useState)(!1),f=Object(u.a)(m,2),v=f[0],b=f[1],p=Object(a.useState)(""),g=Object(u.a)(p,2),h=g[0],_=g[1],E=Object(a.useContext)(d).setStateOnLogin,k=!(n&&i)||v,S=Object(a.useCallback)((function(e){return function(t){return e(t.target.value)}}),[]),y=Object(a.useCallback)((function(e){e.preventDefault(),b(!0),j.login({username:n,password:i}).then((function(e){_(""),E()})).catch((function(e){var t=e.description;_(t),b(!1)}))}),[n,i,E]);return r.a.createElement(O,{className:"form"},r.a.createElement("form",{onSubmit:y},r.a.createElement("h1",{className:"form__title"},"Login"),r.a.createElement("label",{className:"form__item"},"Username",r.a.createElement("input",{name:"username",type:"text",value:n,className:"form__input",onChange:S(c)})),r.a.createElement("label",{className:"form__item"},"Password",r.a.createElement("input",{name:"password",type:"password",className:"form__input",value:i,onChange:S(l)})),r.a.createElement("button",{type:"submit",className:"form__submit",disabled:k},"Send"),h&&r.a.createElement("p",{className:"form__error"},h)))},E=(n(47),n(6)),k=n.n(E);var S=function(){var e=function(){var e=k()(j.subscribe,{shouldReconnect:function(){return!0}}),t=e.lastJsonMessage,n=e.readyState;return{timestamp:null===t||void 0===t?void 0:t.server_time,connected:n===E.ReadyState.OPEN}}(),t=e.timestamp,n=e.connected,c=Object(a.useContext)(d).logout;return r.a.createElement(O,{className:"info"},r.a.createElement("p",{className:"info__text"},"Status:",r.a.createElement("span",{className:"info__status ".concat(n?"info__status--connected":"info__status--disconnected")},n?"connected":"disconnected")),r.a.createElement("p",{className:"info__date"},function(e){try{return new Date(1e3*e).toLocaleString("ru",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})}catch(t){return""}}(t)),r.a.createElement("button",{className:"info__logout",onClick:c},"Logout"))};n(54);var y=function(e){var t=e.children;return r.a.createElement("div",{className:"layout"},t)},N=function(){var e=Object(a.useState)(!!f.get()),t=Object(u.a)(e,2),n=t[0],c=t[1],o=Object(a.useCallback)((function(){return c(!0)}),[c]),s=Object(a.useCallback)((function(){return c(!1)}),[c]),i={isLoggedIn:n,logout:Object(a.useCallback)((function(){s(),f.remove()}),[s]),setStateOnLogin:o,setStateOnLogout:s};return r.a.createElement(d.Provider,{value:i},r.a.createElement(y,null,n?r.a.createElement(S,null):r.a.createElement(_,null)))};o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(N,null)),document.getElementById("root"))}},[[22,1,2]]]);
//# sourceMappingURL=main.a24d3890.chunk.js.map